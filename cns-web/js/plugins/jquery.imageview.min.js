(function(a){function b(c,d){this.init=function(e,f){this.$obj=a(e);this.$targets=a(f.targetSelector,this.$obj);this.opts=f;this.i=0;this.last=this.$targets.length-1;this.deploy()};this.deploy=function(){var e='<div class="imageview"><div class="title"></div><a href="javascript:;" class="hide"></a><a href="javascript:;" class="prev"></a><a href="javascript:;" class="next"></a><div class="image"><img src="" /></div></div>';this.$viewer=a(e).appendTo("body");this.$title=a(".title",this.$viewer);this.$hide=a(".hide",this.$viewer);this.$prev=a(".prev",this.$viewer);this.$next=a(".next",this.$viewer);this.$image=a(".image img",this.$viewer);this.$hide.click(a.proxy(this.hide,this));this.$prev.click(a.proxy(this.prev,this));this.$next.click(a.proxy(this.next,this));this.$image.bind("load",function(){a(this).fadeIn()});a("body").keydown(a.proxy(this.keydown,this));var f=this;this.$targets.each(function(g){a(this).click(function(h){f.show(g);return false})})};this.hide=function(){this.$viewer.fadeOut()};this.keydown=function(f){if(!this.$viewer.is(":visible")){return}if(f.keyCode==37){if(this.i>0){this.prev()}}if(f.keyCode==39){if(this.i<this.last){this.next()}}};this.next=function(){this.show(this.i+1)};this.prev=function(){this.show(this.i-1)};this.show=function(f){var e=this.$targets.eq(f);this.i=f;this.$title.text(e.attr(this.opts.titleAttr));this.$prev.toggle(f>0);this.$next.toggle(f<this.last);this.$viewer.fadeIn();this.$image.hide().attr("src",e.attr(this.opts.srcAttr))};this.init(c,d)}a.fn.imageview=function(d){var c={targetSelector:"a",srcAttr:"href",titleAttr:"title"};var e=a.extend(c,d);return this.each(function(){a(this).data("imageview",new b(this,e))})}})(jQuery);